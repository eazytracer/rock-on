---
title: Enhanced Band Practice Workflow & Song Notes Feature - Research
created: 2025-12-03T18:27
status: Research Complete
description: Comprehensive analysis for implementing enhanced practice workflow with markdown notes, multi-layered notes system, and improved practice session builder
---

# Enhanced Band Practice Workflow & Song Notes Feature

## Executive Summary

This research document analyzes the requirements and provides recommendations for implementing an enhanced band practice workflow feature. The feature encompasses:

1. **Markdown Song Notes** - Adding structured notes to songs with markdown support
2. **Practice Session Display Mode** - Full-screen practice view with timer, navigation, and notes display
3. **Revamped Practice Session Builder** - UI similar to SetlistBuilder with slide-out tray
4. **Multi-layered Notes System** - Band notes, personal notes, and practice log entries (Jira-style)

---

## Part 1: Current State Analysis

### 1.1 Database Schema Analysis

#### Songs Table (Current)

**Location:** `supabase/migrations/20251106000000_baseline_schema.sql` (lines 153-191)

```sql
CREATE TABLE public.songs (
  id UUID PRIMARY KEY,
  title TEXT NOT NULL,
  artist TEXT,
  key TEXT,
  tempo INTEGER,
  time_signature TEXT,
  duration INTEGER,
  difficulty INTEGER DEFAULT 1,
  genre TEXT,
  notes TEXT,                    -- EXISTS! Basic notes field (plain text)
  lyrics_url TEXT,
  chords_url TEXT,
  recording_url TEXT,
  created_date TIMESTAMPTZ,
  updated_date TIMESTAMPTZ,
  last_practiced TIMESTAMPTZ,
  confidence_level INTEGER DEFAULT 1,
  context_type TEXT NOT NULL DEFAULT 'band',
  context_id TEXT NOT NULL,
  created_by UUID NOT NULL,
  visibility TEXT DEFAULT 'band',
  song_group_id UUID,
  version INTEGER DEFAULT 1 NOT NULL,
  last_modified_by UUID
);
```

**Key Finding:** A `notes` field already exists but is plain text. This can be repurposed for markdown content.

#### Practice Sessions Table (Current)

**Location:** `supabase/migrations/20251106000000_baseline_schema.sql` (lines 273-298)

```sql
CREATE TABLE public.practice_sessions (
  id UUID PRIMARY KEY,
  band_id UUID NOT NULL REFERENCES public.bands(id),
  setlist_id UUID REFERENCES public.setlists(id),
  scheduled_date TIMESTAMPTZ NOT NULL,
  start_time TIMESTAMPTZ,
  end_time TIMESTAMPTZ,
  duration INTEGER,
  location TEXT,
  type TEXT NOT NULL,            -- 'rehearsal', 'writing', 'recording', etc.
  notes TEXT,                    -- Session-level notes
  objectives TEXT[],
  completed_objectives TEXT[],
  session_rating INTEGER,
  songs JSONB DEFAULT '[]',      -- Array of SessionSong objects
  attendees JSONB DEFAULT '[]',
  created_date TIMESTAMPTZ,
  version INTEGER DEFAULT 1,
  last_modified_by UUID
);
```

**Key Finding:** Practice sessions store songs as JSONB array. No junction table exists. The `songs` JSONB structure is:

```typescript
// From src/types.ts (SessionSong interface)
interface SessionSong {
  songId: string
  timeSpent: number
  status: 'not-started' | 'in-progress' | 'completed'
  sectionsWorked: string[]
  improvements: string[]
  needsWork: string[]
  memberRatings: MemberRating[]
}
```

#### Missing Schema Elements

1. **No personal song notes table** - Need to create for individual user notes
2. **No practice log entries table** - Need for Jira-style comment history
3. **No show notes table** - If we want notes from shows too

---

### 1.2 Page & Component Structure Analysis

#### PracticesPage.tsx (Current)

**Location:** `src/pages/NewLayout/PracticesPage.tsx`

**Current Features:**

- Lists upcoming and past practices
- `SchedulePracticeModal` for creating/editing practices
- Basic song selection with checkbox pattern
- Auto-suggest from upcoming shows
- Status management (scheduled, completed, cancelled)
- Sync status visualization

**Current Song Selection Pattern (lines 571-633):**

- Simple checkbox list
- Search filter
- "Add from Upcoming Shows" button
- No slide-out tray pattern

**Missing Features for New Workflow:**

- No practice display/presentation mode
- No timer during practice
- No song navigation arrows
- No tuning preview for next song
- No markdown notes rendering
- No setlist filter option
- No "Add All from Setlist" button

#### SetlistBuilder.tsx (Current)

**Location:** `src/components/setlists/SetlistBuilder.tsx`

**Reusable Patterns Found:**

1. **Two-column layout** (lines 523-898):
   - Left: Builder with drag-drop reordering
   - Right: Available songs with search

2. **Drag-and-drop** (lines 54-62, 190-300):
   - Touch event handlers
   - Mouse event handlers
   - Visual feedback with drop zones

3. **Color coding by field** (lines 446-521):
   - Guitar tuning, key, difficulty, readiness
   - Configurable via dropdown

4. **Song metadata display**:
   - Key, BPM, guitar tuning badges
   - Duration formatting
   - Numbered ordering

**Missing for Practice Builder:**

- Slide-out tray pattern (SetlistBuilder uses side-by-side columns)
- Setlist filter option
- "Add All" bulk action

---

### 1.3 Existing Component Inventory

| Component        | Location                                    | Reusable     | Notes                              |
| ---------------- | ------------------------------------------- | ------------ | ---------------------------------- |
| `SetlistBuilder` | `src/components/setlists/`                  | Partial      | Two-column layout, drag-drop logic |
| `SongCard`       | `src/components/songs/SongCard.tsx`         | Yes          | Song display with metadata         |
| `SearchBar`      | `src/components/common/SearchBar.tsx`       | Yes          | Search input component             |
| `TouchButton`    | `src/components/common/TouchButton.tsx`     | Yes          | Touch-friendly buttons             |
| `TimePicker`     | `src/components/common/TimePicker.tsx`      | Yes          | Time selection                     |
| `DurationPicker` | `src/components/common/DurationPicker.tsx`  | Yes          | Duration selection                 |
| `PracticeTimer`  | `src/components/sessions/PracticeTimer.tsx` | Needs Review | Timer component                    |
| `MobileDrawer`   | `src/components/layout/MobileDrawer.tsx`    | Potential    | Could adapt for slide-out          |

---

### 1.4 Dependencies Analysis

**Current package.json (relevant):**

```json
{
  "dependencies": {
    "@dnd-kit/core": "^6.3.1",
    "@dnd-kit/sortable": "^10.0.0",
    "@dnd-kit/utilities": "^3.2.2",
    "lucide-react": "^0.546.0",
    "mermaid": "^11.12.1"
  }
}
```

**Missing Dependencies:**

- **No markdown library** - Need to add `react-markdown` or similar
- **No markdown editor** - May need `@uiw/react-md-editor` or similar

---

## Part 2: Proposed Schema Changes

### 2.1 New Tables Required

#### Table: `song_band_notes` (Band-level markdown notes)

```sql
-- Band-wide notes for a song (shared among all band members)
-- Uses the existing songs.notes field instead of new table
-- Recommendation: Repurpose existing songs.notes as markdown content
```

**Decision:** Use existing `songs.notes` field for band notes (markdown). No new table needed.

#### Table: `song_personal_notes`

```sql
CREATE TABLE public.song_personal_notes (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  song_id UUID NOT NULL REFERENCES public.songs(id) ON DELETE CASCADE,
  user_id UUID NOT NULL REFERENCES public.users(id) ON DELETE CASCADE,
  band_id UUID NOT NULL REFERENCES public.bands(id) ON DELETE CASCADE,
  content TEXT,                    -- Markdown content
  created_date TIMESTAMPTZ NOT NULL DEFAULT NOW(),
  updated_date TIMESTAMPTZ NOT NULL DEFAULT NOW(),
  version INTEGER DEFAULT 1 NOT NULL,

  -- One personal note per user per song per band
  UNIQUE(song_id, user_id, band_id)
);

-- Indexes
CREATE INDEX idx_song_personal_notes_song ON song_personal_notes(song_id);
CREATE INDEX idx_song_personal_notes_user ON song_personal_notes(user_id);
CREATE INDEX idx_song_personal_notes_band ON song_personal_notes(band_id);
```

#### Table: `song_note_entries` (Practice/Show log entries - Jira-style)

```sql
CREATE TABLE public.song_note_entries (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  song_id UUID NOT NULL REFERENCES public.songs(id) ON DELETE CASCADE,
  user_id UUID NOT NULL REFERENCES public.users(id) ON DELETE CASCADE,
  band_id UUID NOT NULL REFERENCES public.bands(id) ON DELETE CASCADE,

  -- Session context (optional - can be general notes too)
  session_type TEXT,               -- 'practice' | 'show' | null (general)
  session_id UUID,                 -- practice_session.id or shows.id

  -- Content
  content TEXT NOT NULL,           -- Markdown content

  -- Timestamps
  created_date TIMESTAMPTZ NOT NULL DEFAULT NOW(),
  updated_date TIMESTAMPTZ,

  CONSTRAINT note_entry_session_type_check
    CHECK (session_type IS NULL OR session_type IN ('practice', 'show'))
);

-- Indexes
CREATE INDEX idx_song_note_entries_song ON song_note_entries(song_id);
CREATE INDEX idx_song_note_entries_user ON song_note_entries(user_id);
CREATE INDEX idx_song_note_entries_band ON song_note_entries(band_id);
CREATE INDEX idx_song_note_entries_session ON song_note_entries(session_type, session_id);
CREATE INDEX idx_song_note_entries_created ON song_note_entries(created_date DESC);
```

### 2.2 RLS Policies Required

```sql
-- song_personal_notes RLS
ALTER TABLE song_personal_notes ENABLE ROW LEVEL SECURITY;

-- Users can read their own personal notes
CREATE POLICY "Users can view own personal notes"
  ON song_personal_notes FOR SELECT
  USING (user_id = auth.uid());

-- Users can create their own personal notes
CREATE POLICY "Users can create own personal notes"
  ON song_personal_notes FOR INSERT
  WITH CHECK (user_id = auth.uid());

-- Users can update their own personal notes
CREATE POLICY "Users can update own personal notes"
  ON song_personal_notes FOR UPDATE
  USING (user_id = auth.uid());

-- Users can delete their own personal notes
CREATE POLICY "Users can delete own personal notes"
  ON song_personal_notes FOR DELETE
  USING (user_id = auth.uid());

-- song_note_entries RLS
ALTER TABLE song_note_entries ENABLE ROW LEVEL SECURITY;

-- Band members can view all note entries for their band
CREATE POLICY "Band members can view note entries"
  ON song_note_entries FOR SELECT
  USING (
    band_id IN (
      SELECT band_id FROM band_memberships
      WHERE user_id = auth.uid() AND status = 'active'
    )
  );

-- Users can create their own note entries
CREATE POLICY "Users can create own note entries"
  ON song_note_entries FOR INSERT
  WITH CHECK (user_id = auth.uid());

-- Users can update their own note entries
CREATE POLICY "Users can update own note entries"
  ON song_note_entries FOR UPDATE
  USING (user_id = auth.uid());

-- Users can delete their own note entries
CREATE POLICY "Users can delete own note entries"
  ON song_note_entries FOR DELETE
  USING (user_id = auth.uid());
```

### 2.3 Schema Migration Strategy

Since we're pre-1.0, per CLAUDE.md guidelines:

1. Add new tables to the baseline migration
2. Test with `supabase db reset`
3. Run `npm run test:db` to verify

---

## Part 3: UI/UX Recommendations

### 3.1 Practice Session Builder (Revamped)

**Pattern:** Adopt SetlistBuilder's approach with enhancements

**Proposed Layout:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Schedule Practice                                       [X] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Basic Info                                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚ â”‚ Date        â”‚ â”‚ Time        â”‚ â”‚ Duration    â”‚           â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Location                                                â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Songs to Practice                                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Filter: [All Songs v] â”‚ â”‚ [+ Add All from Setlist]     â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                             â”‚
â”‚ Selected Songs (drag to reorder):                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ 1. Song Title - Artist â€¢ 3:45 â€¢ Drop D         [x]     â”‚â”‚
â”‚ â”‚ 2. Song Title - Artist â€¢ 4:12 â€¢ Standard       [x]     â”‚â”‚
â”‚ â”‚ 3. Song Title - Artist â€¢ 3:30 â€¢ Drop D         [x]     â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                             â”‚
â”‚ [+ Add Songs]  â†â”€â”€â”€ Opens slide-out tray                   â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              [Cancel]  [Schedule Practice] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Slide-Out Song Tray:**

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Add Songs                         [X] â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚ [Search songs...                    ] â”‚
                    â”‚                                       â”‚
                    â”‚ Filter by Setlist:                    â”‚
                    â”‚ [Upcoming Shows Setlist  v]           â”‚
                    â”‚                                       â”‚
                    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                    â”‚ â”‚ â–¡ Song Title - Artist â€¢ 3:45     â”‚ â”‚
                    â”‚ â”‚ â–¡ Song Title - Artist â€¢ 4:12     â”‚ â”‚
                    â”‚ â”‚ â˜‘ Song Title - Artist â€¢ 3:30     â”‚ â”‚
                    â”‚ â”‚ â–¡ Song Title - Artist â€¢ 2:58     â”‚ â”‚
                    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                    â”‚                                       â”‚
                    â”‚ [Add All from Setlist] [Add Selected] â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Practice Session Display Mode

**Pattern:** Full-screen presentation view for practicing

**Layout:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â—„ Back to Practice     Practice Session          â± 45:23 / 120:00  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ NOW PLAYING                                                     â”‚ â”‚
â”‚  â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚  "Enter Sandman"                                                â”‚ â”‚
â”‚  â”‚   by Metallica                                                  â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚   Key: E minor  â€¢  BPM: 123  â€¢  Duration: 5:32                 â”‚ â”‚
â”‚  â”‚   Tuning: Drop D  â€¢  Difficulty: â˜…â˜…â˜…â˜†â˜†                        â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ## Band Notes                                                   â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ ### Intro (0:00 - 0:45)                                        â”‚ â”‚
â”‚  â”‚ - Clean guitar pattern with tremolo picking                     â”‚ â”‚
â”‚  â”‚ - Bass enters at 0:30                                          â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ ### Verse 1 (0:45 - 1:30)                                      â”‚ â”‚
â”‚  â”‚ - Heavy distortion, palm muted                                  â”‚ â”‚
â”‚  â”‚ - Watch the transition to chorus                                â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ ### Chorus (1:30 - 2:00)                                       â”‚ â”‚
â”‚  â”‚ 1. Full power chords                                            â”‚ â”‚
â”‚  â”‚ 2. Bass follows root notes                                      â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚  â”‚ NEXT UP: "Sad But True"  â”‚ â† Tuning preview                     â”‚
â”‚  â”‚ Tuning: Drop C (change!) â”‚                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚                                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   [â—„ Previous]    Song 3 of 12    [Next â–º]         [â¸ Pause Timer] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 Multi-Layered Notes UI (Jira-Style)

**Pattern:** Tabbed interface with comment-style entries

**Song Notes Panel (during practice or song view):**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Song Notes                                                     [âœ] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Band Notes] [My Notes] [Practice Log]                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ ## Intro Section                                                â”‚â”‚
â”‚ â”‚                                                                 â”‚â”‚
â”‚ â”‚ - 4 bars clean intro                                            â”‚â”‚
â”‚ â”‚ - Use neck pickup                                               â”‚â”‚
â”‚ â”‚                                                                 â”‚â”‚
â”‚ â”‚ ## Main Riff                                                    â”‚â”‚
â”‚ â”‚                                                                 â”‚â”‚
â”‚ â”‚ 1. Start on low E                                               â”‚â”‚
â”‚ â”‚ 2. Hammer-on to G                                               â”‚â”‚
â”‚ â”‚ 3. Pull-off back                                                â”‚â”‚
â”‚ â”‚                                                                 â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Practice Log Tab (Jira-style comments):**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Band Notes] [My Notes] [Practice Log]                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ [Add Note]                                                      â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ ğŸ‘¤ John Smith â€¢ Practice Session - Dec 1, 2025                  â”‚â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚â”‚
â”‚ â”‚ Nailed the bridge section today! The trick is to keep the       â”‚â”‚
â”‚ â”‚ picking hand loose during the fast run.                         â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ ğŸ‘¤ Jane Doe â€¢ Practice Session - Nov 28, 2025                   â”‚â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚â”‚
â”‚ â”‚ Still struggling with the tempo change at 2:30. Need to         â”‚â”‚
â”‚ â”‚ practice this section with a metronome.                         â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ ğŸ‘¤ John Smith â€¢ Show - The Whiskey Room - Nov 25, 2025          â”‚â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚â”‚
â”‚ â”‚ Crowd loved this one! But we rushed the ending.                 â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Part 4: Technical Recommendations

### 4.1 Markdown Library Selection

**Recommendation:** `react-markdown` with `remark-gfm`

**Why:**

- Lightweight (~15KB gzipped)
- Well-maintained (2M+ weekly downloads)
- Supports GitHub Flavored Markdown (tables, strikethrough, etc.)
- Easy to customize with plugins
- Good accessibility

**Installation:**

```bash
npm install react-markdown remark-gfm
```

**Usage Example:**

```tsx
import ReactMarkdown from 'react-markdown'
import remarkGfm from 'remark-gfm'

const MarkdownRenderer: React.FC<{ content: string }> = ({ content }) => (
  <ReactMarkdown
    remarkPlugins={[remarkGfm]}
    className="prose prose-invert max-w-none"
  >
    {content}
  </ReactMarkdown>
)
```

**For Editing:**
Consider `@uiw/react-md-editor` or a simple textarea with preview toggle.

### 4.2 Component Architecture

**New Components to Create:**

```
src/components/
â”œâ”€â”€ practice/
â”‚   â”œâ”€â”€ PracticeBuilder.tsx         # Revamped practice session builder
â”‚   â”œâ”€â”€ PracticeDisplayMode.tsx     # Full-screen practice view
â”‚   â”œâ”€â”€ PracticeTimer.tsx           # Enhanced timer (existing)
â”‚   â”œâ”€â”€ SongNavigator.tsx           # Previous/Next navigation
â”‚   â””â”€â”€ TuningPreview.tsx           # Next song tuning indicator
â”œâ”€â”€ notes/
â”‚   â”œâ”€â”€ MarkdownRenderer.tsx        # Markdown display component
â”‚   â”œâ”€â”€ MarkdownEditor.tsx          # Markdown editing component
â”‚   â”œâ”€â”€ SongNotesPanel.tsx          # Tabbed notes interface
â”‚   â”œâ”€â”€ NoteEntryCard.tsx           # Single log entry (Jira-style)
â”‚   â””â”€â”€ NoteEntryForm.tsx           # Add new note entry
â””â”€â”€ common/
    â””â”€â”€ SlideOutTray.tsx            # Reusable slide-out panel
```

### 4.3 State Management Approach

**Practice Display Mode State:**

```typescript
interface PracticeDisplayState {
  currentSongIndex: number
  isTimerRunning: boolean
  elapsedTime: number // seconds
  totalDuration: number // minutes (session duration)
  activeNotesTab: 'band' | 'personal' | 'log'
}
```

**Notes Data Flow:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SongNotesPanel      â”‚â”€â”€â”€â”€â–¶â”‚ Notes Hooks         â”‚
â”‚ (UI Component)      â”‚     â”‚ - useBandNotes      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ - usePersonalNotes  â”‚
                            â”‚ - useNoteEntries    â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚ Repository Layer    â”‚
                            â”‚ - LocalRepository   â”‚
                            â”‚ - RemoteRepository  â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚ IndexedDB/Supabase  â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 Real-time Sync Considerations

**Note Entries:**

- Enable realtime for `song_note_entries` table
- Other band members should see new log entries appear
- Use existing `RealtimeManager` pattern

**Personal Notes:**

- No need for realtime (user-specific)
- Standard sync via SyncEngine

---

## Part 5: Implementation Phases

### Phase 1: Schema & Foundation

1. Add `song_personal_notes` table to baseline
2. Add `song_note_entries` table to baseline
3. Add RLS policies
4. Create IndexedDB tables in Dexie schema
5. Create repository methods
6. Add `react-markdown` dependency

### Phase 2: Notes Components

1. Create `MarkdownRenderer` component
2. Create `MarkdownEditor` component
3. Create `SongNotesPanel` with tabs
4. Create `NoteEntryCard` and `NoteEntryForm`
5. Add notes panel to song view

### Phase 3: Practice Builder Revamp

1. Create `SlideOutTray` component
2. Create enhanced `PracticeBuilder` component
3. Add setlist filter dropdown
4. Add "Add All from Setlist" button
5. Integrate into PracticesPage

### Phase 4: Practice Display Mode

1. Create `PracticeDisplayMode` component
2. Create `SongNavigator` component
3. Create `TuningPreview` component
4. Enhance `PracticeTimer` component
5. Add route and entry points

### Phase 5: Integration & Polish

1. Add notes panel to practice display
2. Enable note entry creation during practice
3. Add show context for note entries
4. Test realtime sync
5. Mobile responsiveness

---

## Part 6: Open Questions for User

1. **Markdown Complexity:**
   - Should we support full GFM (tables, task lists, etc.) or basic markdown only? Basic markdown is fine
   - Do you want syntax highlighting for code blocks (for tabs/chords)? Let's keep it simple for now, no syntax highlighting

2. **Note Entry Visibility:**
   - Should practice log entries be visible to all band members or just the author? Let's let the user choose public/private when adding notes.
   - Current proposal: All band members can view, only author can edit/delete. I like this, but also band admin should be able to delete.

3. **Mobile Experience:**
   - Should the practice display mode work on mobile, or is it primarily for large screens? Mobile as well, but it doesn't need to behave exactly the same. It would be great to have a large timer display and easy button to next song, with preview, but song notes can be scrollable.
   - How should markdown editing work on mobile? Ideally they click into text field or hit the edit button and it's just plain-text markdown, they will have to use symbols for h1 (#), h2 (##), etc. We could add a modal with markdown overview.

4. **Timer Behavior:**
   - Should the timer auto-advance to next song after a configurable duration? No, let's keep it simple and make it user controlled for now, but if they scroll through the songs, we can make it like a lap timer where it tracks time on each song.
   - Should there be per-song timing or just session-level timing? See above relating to "lap timer" type functionality

5. **Feature Priority:**
   - Which phase should we prioritize first? Let's just try to knock it all out.
   - Is the revamped builder more urgent than the display mode? I think we can get it all going.

---

## Part 7: Risk Assessment

### High Risk

| Risk                                  | Mitigation                                                    |
| ------------------------------------- | ------------------------------------------------------------- |
| Schema changes to existing tables     | Repurpose existing `notes` field instead of adding new column |
| Large markdown content affecting sync | Implement content size limits, consider lazy loading          |
| Complex UI state in display mode      | Use proper state management, consider useReducer              |

### Medium Risk

| Risk                                       | Mitigation                                                   |
| ------------------------------------------ | ------------------------------------------------------------ |
| Markdown rendering performance             | Use `react-markdown` memoization, virtualize long note lists |
| Mobile markdown editing UX                 | Start with simple textarea, iterate based on feedback        |
| Real-time sync complexity for note entries | Leverage existing RealtimeManager patterns                   |

### Low Risk

| Risk                                | Mitigation                                                 |
| ----------------------------------- | ---------------------------------------------------------- |
| Adding new dependencies             | `react-markdown` is well-maintained with minimal footprint |
| Component reuse from SetlistBuilder | Logic is well-isolated, can adapt patterns                 |
| Timer functionality                 | Existing PracticeTimer component as foundation             |

---

## Part 8: File References

### Key Files to Modify

- `supabase/migrations/20251106000000_baseline_schema.sql` - Add new tables
- `src/services/data/database.ts` - Add Dexie tables
- `src/services/data/LocalRepository.ts` - Add repository methods
- `src/services/data/RemoteRepository.ts` - Add repository methods
- `src/pages/NewLayout/PracticesPage.tsx` - Integrate new builder
- `package.json` - Add react-markdown

### Key Files to Reference

- `src/components/setlists/SetlistBuilder.tsx` - Drag-drop patterns
- `src/components/layout/MobileDrawer.tsx` - Slide-out pattern reference
- `src/components/sessions/PracticeTimer.tsx` - Timer component
- `.claude/specifications/unified-database-schema.md` - Schema reference

---

## Conclusion

This feature is well-scoped and builds on existing patterns in the codebase. The main challenges are:

1. **Schema additions** - Two new tables with RLS policies
2. **UI complexity** - Multiple new components with interconnected state
3. **Markdown integration** - New dependency and rendering considerations

The recommended approach is to implement in phases, starting with the schema foundation and notes components, then building the UI features incrementally. This allows for user feedback at each stage and reduces risk.

**Estimated Scope:** Medium-Large feature (based on similar features in codebase)
